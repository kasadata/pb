<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lotto Logic — Documentary Mode (V2)</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <div id="app" class="layout">
    <header class="topbar" id="topbar">
      <div class="brand">
        <div class="title">Lotto Logic</div>
        <div class="subtitle">Documentary Mode (V2)</div>
      </div>

      <div class="status">
        <div class="kv"><span class="k">Draw</span><span class="v" id="drawId">—</span></div>
        <div class="kv"><span class="k">Jackpot</span><span class="v" id="jackpot">—</span></div>
        <div class="kv"><span class="k">P(Hit)</span><span class="v" id="pHit">—</span></div>
        <div class="kv"><span class="k">Total</span><span class="v" id="totalDraws">—</span></div>
      </div>

      <div class="controls">
        <button class="btn" id="btnPlayPause">▶</button>
        <button class="btn" id="btnSpeed">⏩ 1x</button>
        <button class="btn" id="btnJackpotMode">Cash</button>
        <button class="btn" id="btnFocus">Focus</button>
        <button class="btn" id="btnFullscreen">⛶</button>
        <button class="btn" id="btnNewRun">New run</button>
      </div>
    </header>

    <main class="chartPane">
      <div class="paneTitle">Main Chart</div>
      <canvas id="chart" width="1200" height="700" aria-label="Main chart"></canvas>
      <div class="chartHint">
        Wheel: zoom X · Shift+Wheel: zoom Y · Drag: pan · Double-click: reset
      </div>
      <div class="legend" id="legend"></div>
      <div class="buildOverlay hidden" id="buildOverlay">
        <div class="buildCard">
          <div class="buildTitle">Building 100-year history…</div>
          <div class="buildSub">Monte Carlo simulation in progress. UI will update when ready.</div>
        </div>
      </div>
    </main>

    <aside class="sidePane" id="sidePane">
      <div class="paneTitle">Ranking</div>
      <ol class="ranking" id="ranking"></ol>

      <div class="paneTitle">Players</div>
      <div class="players" id="players"></div>

      <div class="paneTitle">Options</div>
      <div class="options">

        <details class="details" open>
          <summary>Player setup (max 5)</summary>
          <div class="smallNote">Enable up to 5 players. Strategy does not change jackpot odds per ticket.</div>
          <div class="playerGrid" id="playerGrid"></div>

          <div class="row">
            <label class="label">Addon</label>
            <select id="addonMode" class="select">
              <option value="none">None</option>
              <option value="pp">Power Play (+$1)</option>
              <option value="dp">Double Play (+$1)</option>
            </select>
          </div>
        </details>

        <details class="details" open>
          <summary>Strategy B filters (advanced)</summary>
          <div class="smallNote">Filter-only. No weighting, no optimization, no “best numbers”.</div>

          <div class="row">
            <label class="label">Sum range</label>
            <div class="inline2">
              <input id="bSumMin" class="input" type="number" min="5" max="345" value="130" />
              <input id="bSumMax" class="input" type="number" min="5" max="345" value="220" />
            </div>
          </div>

          <div class="row">
            <label class="label">Odd/Even</label>
            <div class="inline2">
              <label class="check"><input type="checkbox" id="bExcludeAllOddEven" checked /> exclude 5:0 / 0:5</label>
            </div>
          </div>

          <div class="row">
            <label class="label">Small/Big</label>
            <div class="inline2">
              <input id="bSmallMax" class="input" type="number" min="10" max="59" value="34" />
              <label class="check"><input type="checkbox" id="bExcludeAllSmallBig" checked /> exclude 5:0 / 0:5</label>
            </div>
          </div>

          <div class="row">
            <label class="label">Max consecutive pairs</label>
            <input id="bMaxConsec" class="input" type="number" min="0" max="4" value="1" />
          </div>

          <div class="row">
            <label class="label">Sectors allowed</label>
            <div class="inline2">
              <input id="bMinSectors" class="input" type="number" min="1" max="7" value="2" />
              <input id="bMaxSectors" class="input" type="number" min="1" max="7" value="4" />
            </div>
          </div>

          <div class="row">
            <label class="label">Max tail pairs</label>
            <input id="bMaxTailPairs" class="input" type="number" min="0" max="4" value="1" />
          </div>

          <div class="row">
            <label class="label">Candidate pool</label>
            <div class="inline2">
              <input id="bPoolInit" class="input" type="number" min="100" max="5000" step="100" value="500" />
              <input id="bPoolMax" class="input" type="number" min="1000" max="50000" step="1000" value="20000" />
            </div>
          </div>
        </details>

        <details class="details" open>
          <summary>Power ME tickets (editable before start)</summary>
          <div class="smallNote">Used by any “Fixed tickets” player. Format: 5 lines. Each line: 5 white numbers | PB</div>
          <textarea id="fixedTickets" class="textarea" rows="7" spellcheck="false"></textarea>
          <div class="row right">
            <button class="btn" id="btnApplyFixed">Apply tickets</button>
          </div>
        </details>

        <details class="details">
          <summary>Simulation</summary>
          <div class="row">
            <label class="label">Years</label>
            <input id="years" class="input" type="number" min="1" max="100" value="100" />
          </div>
          <div class="row">
            <label class="label">Start cash jackpot</label>
            <input id="startJackpot" class="input" type="number" min="20000000" step="1000000" value="20000000" />
          </div>
          <div class="row right">
            <button class="btn" id="btnRebuild">Rebuild history</button>
          </div>
          <div class="smallNote">Rebuild re-runs the full Monte Carlo history with the current settings and seed.</div>
        </details>

        <details class="details">
          <summary>Export</summary>
          <div class="row right">
            <button class="btn" id="btnExportNarration">Export Narration (TXT)</button>
            <button class="btn" id="btnExportSummary">Export Summary (MD)</button>
          </div>
        </details>
      </div>
    </aside>

    <footer class="bottombar" id="bottombar">
      <div class="timelineRow">
        <div class="tlLeft">
          <div class="kv"><span class="k">Since Jackpot</span><span class="v" id="sinceJackpot">—</span></div>
          <div class="kv"><span class="k">Speed</span><span class="v" id="speedText">—</span></div>
        </div>

        <div class="tlMid">
          <input id="timeline" type="range" min="0" max="0" value="0" />
          <div class="tickline" id="tickline"></div>
        </div>

        <div class="tlRight">
          <button class="btn" id="btnWhy">Why?</button>
        </div>
      </div>

      <div class="narration" id="narration">
        <div class="nLine" id="nLineMain">(silence)</div>
        <div class="nWhy hidden" id="nWhy">
          <div class="nLine" id="nLineRational"></div>
          <div class="nLine" id="nLineNotes"></div>
        </div>
      </div>
    </footer>
  </div>

  <script src="./app.js"></script>
</body>
</html>
